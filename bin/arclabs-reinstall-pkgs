#!/bin/bash
set -e

# Reinstall all default ArcLabs packages from the stable channel and downgrade any packages that are too new.

# Set the package repository to the stable mirrors
arclabs-refresh-pacman

# Downgrade any packages to the stable setup
sudo pacman -Suu --noconfirm

# Ensure all packages are installed
mapfile -t packages < <(grep -v '^#' "$ARCLABS_PATH/install/arclabs-base.packages" | grep -v '^$')
sudo pacman -Syu --noconfirm --needed "${packages[@]}"
